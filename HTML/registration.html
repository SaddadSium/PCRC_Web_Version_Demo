<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration | PCRC</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../CSS/registration.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>

    <header class="header-wrapper">
        <nav class="navbar">
            <div class="nav-container">
                <a href="../index.html" class="logo">
                    <img src="../IMG/PLG.jpg" alt="PCRC Logo">
                </a>
                <input type="checkbox" id="check" aria-label="Toggle Navigation Menu">
                <label for="check" class="menu-btn"><i class="fas fa-bars"></i></label>
                <ul class="nav-menu">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="competition.html">Competition</a></li>
                    <li><a href="activity.html">Activities</a></li>
                    <li class="reg-item"><a href="registration.html" class="active">Register</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="reg-wrapper">
        <div class="reg-container">
            <div class="reg-header">
                <h1>Join <span>PCRC</span></h1>
                <p>Become a part of the biggest creative platform of BMARPC.</p>
            </div>

            <form id="registration-form" class="reg-form">
                <div class="input-group">
                    <div class="input-box">
                        <label>Full Name</label>
                        <input type="text" id="name" placeholder="Enter your full name" required>
                    </div>
                    <div class="input-box">
                        <label>Class Roll</label>
                        <input type="number" id="roll" placeholder="Enter your roll" required>
                    </div>
                </div>

                <div class="input-group">
                    <div class="input-box">
                        <label>Section</label>
                        <input type="text" id="section" placeholder="Enter your section" required>
                    </div>
                    <div class="input-box">
                        <label>Gender</label>
                        <select id="gender" required>
                            <option value="" disabled selected>Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                </div>

                <div class="input-box">
                    <label>Class Teacher Name</label>
                    <input type="text" id="teacher" placeholder="Enter teacher's name" required>
                </div>

                <div class="input-group">
                    <div class="input-box">
                        <label>Phone Number</label>
                        <input type="tel" id="phone" placeholder="01XXXXXXXXX" required>
                    </div>
                    <div class="input-box">
                        <label>Email Address</label>
                        <input type="email" id="email" placeholder="example@gmail.com" required>
                    </div>
                </div>

                <div class="input-group">
                    <div class="input-box">
                        <label>Social ID (Facebook/Insta)</label>
                        <input type="text" id="social" placeholder="Profile Link or Username" required>
                    </div>
                    <div class="input-box">
                        <label>Portfolio Link</label>
                        <input type="url" id="portfolio" placeholder="Behance/Drive/Website">
                    </div>
                </div>

                <div class="input-box">
                    <label>Join As A</label>
                    <select id="department" required>
                        <option value="" disabled selected>Choose your department</option>
                        <option value="Photographer">Photographer</option>
                        <option value="Cinematographer">Cinematographer</option>
                        <option value="Artist">Artist</option>
                    </select>
                </div>

                <div class="file-drop-area">
    <i class="fas fa-cloud-upload-alt"></i>
    <span id="file-label">Choose file or drag & drop</span>
    <input type="file" id="photo" name="Photo" accept="image/*" required>
    </div>

                <button type="submit" class="submit-btn" id="submit-btn">
                    Submit Registration <i class="fas fa-paper-plane"></i>
                </button>
                
                <div class="form-footer">
                    <a href="../index.html"><i class="fas fa-arrow-left"></i> Back to Home</a>
                </div>
            </form>
        </div>
    </div>

   <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxXOaA0dKkyQ2qhnbN2h01eQTZEvDb_h12CIpjVHVJ8NZvJnA5AIW39oCkDnuTEBYytzQ/exec'; // New Deployment URL din
    const form = document.getElementById('registration-form');
    const btn = document.getElementById('submit-btn');
    const fileInput = document.getElementById('photo');
    const fileLabel = document.getElementById('file-label');

    // Chobi select korle nam dekhano
    fileInput.addEventListener('change', function() {
        if (this.files && this.files.length > 0) {
            fileLabel.innerHTML = `<i class="fas fa-file-image"></i> ${this.files[0].name}`;
            fileLabel.style.color = "#e91e63"; 
        }
    });

    form.addEventListener('submit', e => {
        e.preventDefault();
        btn.disabled = true;
        btn.innerHTML = "Submitting Data...";

        const file = fileInput.files[0];
        const reader = new FileReader();

        reader.onloadend = function() {
            const data = {
                name: document.getElementById('name').value,
                roll: document.getElementById('roll').value,
                section: document.getElementById('section').value,
                gender: document.getElementById('gender').value,
                teacher: document.getElementById('teacher').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                social: document.getElementById('social').value,
                portfolio: document.getElementById('portfolio').value,
                department: document.getElementById('department').value,
                photo: reader.result 
            };

            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify(data),
                mode: 'no-cors' // Error thakle eta 'cors' try korun
            })
            .then(() => {
                btn.disabled = false;
                btn.innerHTML = "Submit Registration <i class='fas fa-paper-plane'></i>";
                alert("Success! Data has been sent to Google Sheet.");
                form.reset();
                fileLabel.innerHTML = "Choose file or drag & drop";
            })
            .catch(err => {
                btn.disabled = false;
                btn.innerHTML = "Submit Registration <i class='fas fa-paper-plane'></i>";
                alert("Something went wrong. Check Console!");
                console.error('Error!', err);
            });
        };

        if (file) {
            reader.readAsDataURL(file);
        } else {
            alert("Please select a photo.");
            btn.disabled = false;
            btn.innerHTML = "Submit Registration";
        }
    });
</script>
</body>
</html>